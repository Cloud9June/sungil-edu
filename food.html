<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <title>ğŸ± ì´ë²ˆ ì£¼ ê¸‰ì‹</title>
  <style>
    body {
      font-family: 'Apple SD Gothic Neo', sans-serif;
      background: #eef4f8;
      padding: 30px;
      text-align: center;
    }

    .card {
      background: #fff;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      max-width: 800px;
      margin: 0 auto 40px;
    }

    h1 {
      font-size: 40px;
      margin-bottom: 20px;
    }

    .date {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 8px;
    }

    .dish {
      font-size: 15px;
      white-space: pre-line;
      line-height: 1.5;
    }

    .nutrition {
      font-size: 16px;
      color: #666;
      margin-top: 15px;
    }

    .quote-box {
      margin-top: 20px;
      padding: 20px;
      background: #fff9e5;
      border-radius: 12px;
      font-size: 17px;
      font-style: italic;
      color: #555;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    .week-section {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      padding: 30px;
      max-width: 800px;
      margin: 0 auto;
    }

    .week-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 10px;
    }

    .flip-card {
      background-color: transparent;
      flex: 1 1 120px;
      width: 150px;
      height: 190px;
      perspective: 1000px;
      flex-shrink: 0;
      cursor: pointer;
    }

    .flip-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }

    .flip-card.flipped .flip-inner {
      transform: rotateY(180deg);
    }

    .flip-front, .flip-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      box-sizing: border-box;
    }

    .flip-front {
      /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€ */
      font-weight: bold;
      font-size: 20px;
      border: 2px solid #444;
      color: #333; /* í…ìŠ¤íŠ¸ ìƒ‰ìƒì„ ì–´ë‘¡ê²Œ ìœ ì§€í•˜ì—¬ ê°€ë…ì„± í™•ë³´ */
    }

    /* íŒŒìŠ¤í…”í†¤ ê·¸ë¼ë°ì´ì…˜ ì ìš© */
    .flip-card:nth-child(1) .flip-front { /* ì›”ìš”ì¼ */
        background: linear-gradient(to bottom right, #cceeff, #aaddff);
        border-color: #8bb4d1; /* ë¶€ë“œëŸ¬ìš´ ì²­íšŒìƒ‰ í…Œë‘ë¦¬ */
    }
    .flip-card:nth-child(2) .flip-front { /* í™”ìš”ì¼ */
        background: linear-gradient(to bottom right, #d4edda, #b0e0bb);
        border-color: #92b19e; /* ì°¨ë¶„í•œ ë…¹íšŒìƒ‰ í…Œë‘ë¦¬ */
    }
    .flip-card:nth-child(3) .flip-front { /* ìˆ˜ìš”ì¼ */
        background: linear-gradient(to bottom right, #fff0c1, #ffe48e);
        border-color: #d1c18d; /* ë¶€ë“œëŸ¬ìš´ í™©ê°ˆìƒ‰ í…Œë‘ë¦¬ */
    }
    .flip-card:nth-child(4) .flip-front { /* ëª©ìš”ì¼ */
        background: linear-gradient(to bottom right, #ffe0ed, #ffc6e0);
        border-color: #d1a5b6; /* ì€ì€í•œ í•‘í¬ ë³´ë¼ í…Œë‘ë¦¬ */
    }
    .flip-card:nth-child(5) .flip-front { /* ê¸ˆìš”ì¼ */
        background: linear-gradient(to bottom right, #ffe8d4, #ffdcb4);
        border-color: #d1b49f; /* ë”°ëœ»í•œ ë² ì´ì§€ ì˜¤ë Œì§€ í…Œë‘ë¦¬ */
    }

    .flip-back {
        /* background: #e0f8e9; ì œê±° */
        transform: rotateY(180deg);
        font-size: 15px;
        line-height: 1.5;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        overflow-y: auto;
        border: 1px solid #ccc; /* ê¸°ë³¸ í…Œë‘ë¦¬ ìœ ì§€ ë˜ëŠ” ì•„ë˜ì—ì„œ ë³€ê²½ */
        white-space: pre-line;
        padding: 16px;
        text-align: center;
        color: #333; /* ë’·ë©´ í…ìŠ¤íŠ¸ ìƒ‰ìƒë„ ì–´ë‘¡ê²Œ ìœ ì§€ */
    }

    /* flip-backì—ë„ ë™ì¼í•œ íŒŒìŠ¤í…”í†¤ ê·¸ë¼ë°ì´ì…˜ ì ìš© */
    .flip-card:nth-child(1) .flip-back { /* ì›”ìš”ì¼ */
        background: linear-gradient(to bottom right, #cceeff, #aaddff);
        border-color: #8bb4d1;
    }
    .flip-card:nth-child(2) .flip-back { /* í™”ìš”ì¼ */
        background: linear-gradient(to bottom right, #d4edda, #b0e0bb);
        border-color: #92b19e;
    }
    .flip-card:nth-child(3) .flip-back { /* ìˆ˜ìš”ì¼ */
        background: linear-gradient(to bottom right, #fff0c1, #ffe48e);
        border-color: #d1c18d;
    }
    .flip-card:nth-child(4) .flip-back { /* ëª©ìš”ì¼ */
        background: linear-gradient(to bottom right, #ffe0ed, #ffc6e0);
        border-color: #d1a5b6;
    }
    .flip-card:nth-child(5) .flip-back { /* ê¸ˆìš”ì¼ */
        background: linear-gradient(to bottom right, #ffe8d4, #ffdcb4);
        border-color: #d1b49f;
    }

    /* ì˜¤ëŠ˜ ìš”ì¼ ê°•ì¡° ìŠ¤íƒ€ì¼ì€ ìœ ì§€ (ì›í•œë‹¤ë©´ ì´ê³³ë„ íŒŒìŠ¤í…”í†¤ìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥) */
    .flip-front.today {
        background-color: #dfffe2; /* í˜„ì¬ ì—°í•œ ì´ˆë¡ìƒ‰ ìœ ì§€ */
        border: 2px solid #4CAF50;
        transform: scale(1.03);
        font-weight: bold;
        box-shadow: 0 4px 10px rgba(0, 128, 0, 0.2);
    }
  </style>
</head>

<body>
  <button onclick="location.href='https://cloud9june.github.io/sungil-edu/sungilKiosk.html'" style="position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
          font-size: 22px; padding: 14px 30px;
          background: white; color: #111;
          border: 2px solid #444; border-radius: 14px;
          box-shadow: 0 4px 10px rgba(0,0,0,0.05);
          transition: all 0.2s ease;
          font-family: 'Pretendard', sans-serif;" onmousedown="this.style.transform='translateX(-50%) scale(0.96)'"
    onmouseup="this.style.transform='translateX(-50%) scale(1)'"
    ontouchstart="this.style.transform='translateX(-50%) scale(0.96)'"
    ontouchend="this.style.transform='translateX(-50%) scale(1)'">
    ğŸ  í™ˆìœ¼ë¡œ
  </button>

  <div class="card" id="today-section">
    <h1>ğŸ½ï¸ ì˜¤ëŠ˜ì˜ ê¸‰ì‹</h1>
    <div class="date" id="today-date">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>
    <div id="today-meal" class="dish"></div>
    <div class="nutrition" id="today-nutrition"></div>
    <div class="quote-box" id="meal-quote"></div>
  </div>

  <div class="week-section">
    <h1>ğŸ“… ì´ë²ˆ ì£¼ ê¸‰ì‹</h1>
    <div class="week-grid" id="week-meals"></div>
  </div>

  <script>
    const officeCode = "J10";
    const schoolCode = "7530591";
    const key = "86d5824114ac4902a87d57ce9146867d";

    const now = new Date();
    const yyyy = now.getFullYear(); // ìˆ˜ì •ëœ ë³€ìˆ˜ëª… ì ìš©
    const mm = String(now.getMonth() + 1).padStart(2, '0');
    const dd = String(now.getDate()).padStart(2, '0');
    const todayStr = `${yyyy}${mm}${dd}`;

    const weekDays = [];
    const monday = new Date(now);
    // í˜„ì¬ ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì›”ìš”ì¼ì„ ê³„ì‚°í•©ë‹ˆë‹¤. (ì¼ìš”ì¼:0 ~ í† ìš”ì¼:6)
    // í˜„ì¬ ìš”ì¼ì´ ì¼ìš”ì¼(0)ì´ë©´ 6ì„ ë¹¼ì„œ ì´ì „ ì£¼ ì›”ìš”ì¼ë¡œ, ê·¸ ì™¸ì—ëŠ” (í˜„ì¬ìš”ì¼ - 1)ì„ ë¹¼ì„œ í˜„ì¬ ì£¼ ì›”ìš”ì¼ë¡œ.
    monday.setDate(now.getDate() - (now.getDay() === 0 ? 6 : now.getDay() - 1));
    
    for (let i = 0; i < 5; i++) { // ì›”ìš”ì¼ë¶€í„° ê¸ˆìš”ì¼ê¹Œì§€ 5ì¼
      const d = new Date(monday);
      d.setDate(monday.getDate() + i);
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, '0');
      const day = String(d.getDate()).padStart(2, '0');
      weekDays.push({
        key: `${y}${m}${day}`,
        label: d.toLocaleDateString('ko-KR', { weekday: 'short' }) // 'ì›”', 'í™”' ë“±ìœ¼ë¡œ í‘œì‹œ
      });
    }

    const url = `https://open.neis.go.kr/hub/mealServiceDietInfo?KEY=${key}&Type=json&ATPT_OFCDC_SC_CODE=${officeCode}&SD_SCHUL_CODE=${schoolCode}&MLSV_FROM_YMD=${weekDays[0].key}&MLSV_TO_YMD=${weekDays[4].key}`;

    fetch(url)
      .then(res => res.json())
      .then(data => {
        // ê¸‰ì‹ ì •ë³´ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ ì‚¬ìš©
        const meals = data.mealServiceDietInfo?.find(d => d.row)?.row || [];

        // ì˜¤ëŠ˜ ê¸‰ì‹ ì •ë³´ ì°¾ê¸° (ì¤‘ì‹ ê¸°ì¤€)
        const todayData = meals.find(m => m.MLSV_YMD === todayStr && m.MMEAL_SC_NM === "ì¤‘ì‹");
        const todayMeal = document.getElementById("today-meal");
        const todayDate = document.getElementById("today-date");
        const todayNutrition = document.getElementById("today-nutrition");

        // ì˜¤ëŠ˜ ë‚ ì§œ í‘œì‹œ
        todayDate.textContent = new Date(now).toLocaleDateString("ko-KR", {
          year: "numeric", month: "long", day: "numeric", weekday: "long"
        });

        if (todayData) {
          // ë©”ë‰´ ì •ë³´ì—ì„œ ê´„í˜¸ ì•ˆì˜ ë‚´ìš©ê³¼ HTML íƒœê·¸ ì œê±° ë° ì¤„ë°”ê¿ˆ ì²˜ë¦¬
          const dish = todayData.DDISH_NM.replace(/<br\s*\/?>/g, '\n').replace(/\([^)]*\)/g, "");
          todayMeal.innerText = dish;
          // ì˜ì–‘ ì •ë³´ë„ HTML íƒœê·¸ ì œê±° ë° ì½¤ë§ˆë¡œ êµ¬ë¶„
          todayNutrition.innerText = `ì¹¼ë¡œë¦¬: ${todayData.CAL_INFO} / ì£¼ìš” ì˜ì–‘ì†Œ: ${todayData.NTR_INFO.replace(/<br\/?>/g, ', ')}`;
        } else {
          todayMeal.innerText = "ì˜¤ëŠ˜ ê¸‰ì‹ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.";
          todayNutrition.innerText = ""; // ì •ë³´ê°€ ì—†ì„ ë•Œ ì˜ì–‘ ì •ë³´ë„ ë¹„ì›Œì¤ë‹ˆë‹¤.
        }

        // ğŸ€ ë™ê¸°ë¶€ì—¬ ë©˜íŠ¸ (ë‚ ì§œì— ë”°ë¼ ë‹¬ë¼ì§)
        const quotes = [
            "ğŸš ì˜¤ëŠ˜ ê¸‰ì‹ ë¨¹ê³  ì²´ë ¥ ë§Œë ™ ì°ì!",
            "ğŸ´ ë°°ê³ í”„ë©´ ì§‘ì¤‘ë ¥ë„ ë¡œê·¸ì•„ì›ƒë¨.",
            "ğŸ“± ì¸ìŠ¤íƒ€ ê°ì„±ë³´ë‹¤ ê¸‰ì‹ ì‚¬ì§„ì´ ë¦¬ì–¼ íë§ì´ì§€.",
            "ğŸ¥— ì§„ì§œ ë©‹ìˆëŠ” ì‚¬ëŒì€ ê¸‰ì‹ë„ ì•ˆ ë‚¨ê¸´ë‹¤.",
            "ğŸ˜ ë°¥ ì•ˆ ë¨¹ê³  ë²„í‹°ëŠ” ê±´ ëŠ¥ë ¥ì´ ì•„ë‹ˆë¼ ë¬´ë¦¬ìˆ˜!",
            "ğŸ§ƒ ì ì‹¬ì€ ì†Œì¤‘í•´, ì˜¤ëŠ˜ë„ ë¦¬ì…‹ íƒ€ì„!",
            "ğŸ§  ê³µë¶€ëŠ” ëª°ë¼ë„ ë°¥ì€ ì±™ê¸°ì.",
            "ğŸš€ ë°° ì±„ì›Œì•¼ ì¸ìƒ ì¶”ì§„ë ¥ë„ ìƒê¸´ë‹¤.",
            "ğŸ¯ ê¸‰ì‹ ë¨¹ëŠ” ê±´ ìê¸°ê´€ë¦¬ì˜ ì‹œì‘.",
            "ğŸ’¡ ê³µë³µ ìƒíƒœë¡œ ì²œì¬ ë˜ê¸´ í˜ë“¤ì–´.",
            "ğŸ™Œ ë°¥ ë¨¹ëŠ” ê²ƒë„ ì‹¤ë ¥ì´ì•¼. ì§„ì‹¬.",
            "ğŸ§˜ ë°¥ ì˜ ì±™ê²¨ì•¼ ë©˜íƒˆë„ ì•ˆ í”ë“¤ë¦¼.",
            "ğŸ“† ì˜¤ëŠ˜ ê¸‰ì‹ì´ ì˜¤ëŠ˜ì˜ í•˜ì´ë¼ì´íŠ¸.",
            "ğŸ§‘â€ğŸ³ ë§Œë“  ë¶„ì„ ìœ„í•´ì„œë¼ë„ í•œ ì… ë”!",
            "ğŸ˜‹ ë°¥ í•œ ë¼ì—ë„ ì§„ì‹¬ì¸ ì‚¬ëŒì´ ë˜ì.",
            "ğŸ’¬ ë°¥ì‹¬ìœ¼ë¡œ ì‚´ì•„ê°€ëŠ” ìš°ë¦¬ë“¤ í™”ì´íŒ…!",
            "ğŸ¥¢ ê¸‰ì‹ ì¤„ ì„¤ ë• ì¢€ ì„¤ë ˆëŠ” ê±° ë‚˜ë§Œ ê·¸ë˜?",
            "ğŸ§ ìŒì•…ë³´ë‹¤ ì¤‘ìš”í•œ ê±´â€¦ ë°¥ì´ì•¼.",
            "ğŸƒ ì˜¤ëŠ˜ë„ ë‹¬ë¦¬ëŠ” ë„ˆ, ì—°ë£ŒëŠ” ê¸‰ì‹ì´ì•¼.",
            "ğŸª ê±°ìš¸ ë³´ê¸° ì „ì— ë°¥ë¶€í„° ë¨¹ì.",
            "ğŸ‘• íŒ¨ì…˜ë„ ì¤‘ìš”í•˜ì§€ë§Œ ë°¥ì‹¬ì´ ê¸°ë³¸ì´ì§€.",
            "ğŸ“š ìˆ˜ì—…ë³´ë‹¤ ê¸‰ì‹ì´ ê¸°ë‹¤ë ¤ì§€ëŠ” ê±´ ì •ìƒ.",
            "ğŸ˜´ ì ì‹¬ ì•ˆ ë¨¹ìœ¼ë©´ ì˜¤í›„ëŠ” ì—ë„ˆì§€ OFF.",
            "ğŸ“¶ ê¸‰ì‹ì€ ë‚´ í•˜ë£¨ì˜ ì¶©ì „ê¸°!",
            "ğŸ¥¹ ë‚˜ ìì‹ ì—ê²Œ ì£¼ëŠ” ì†Œì†Œí•œ ì„ ë¬¼: ê¸‰ì‹.",
            "ğŸŒˆ ë³„ì¼ ì—†ì–´ë„ ë°¥ì€ ì±™ê¸°ì. ê·¸ê²Œ ì‚¶ì´ì§€.",
            "ğŸ”¥ ë­˜ í•˜ë“  ì—ë„ˆì§€ê°€ í•„ìš”í•˜ë‹ˆê¹Œ.",
            "ğŸ“¸ ì˜¤ëŠ˜ ê¸‰ì‹ ë¹„ì£¼ì–¼ ì¢€ ê´œì°®ì€ë°?",
            "ğŸ«¶ ë¨¹ê³  ì›ƒê³  ì‚´ì•„ê°€ëŠ” ê²Œ ì œì¼ì´ì•¼.",
            "ğŸ’­ ë‚´ì¼ ê±±ì •ì€ ë‚´ì¼ í•˜ê³ , ì§€ê¸ˆì€ ë°¥."
        ];

        const quoteBox = document.getElementById("meal-quote");
        const dayOfMonth = now.getDate(); // í˜„ì¬ ë‚ ì§œì˜ 'ì¼' ë¶€ë¶„
        quoteBox.textContent = quotes[(dayOfMonth - 1) % quotes.length];


        // ì£¼ê°„ ê¸‰ì‹ ì¹´ë“œ ìƒì„±
        const weekContainer = document.getElementById("week-meals");
        weekDays.forEach(day => {
            const meal = meals.find(m => m.MLSV_YMD === day.key && m.MMEAL_SC_NM === "ì¤‘ì‹");
            // ë©”ë‰´ ì •ë³´ì—ì„œ ê´„í˜¸ ì•ˆì˜ ë‚´ìš©ê³¼ HTML íƒœê·¸ ì œê±° ë° ì¤„ë°”ê¿ˆ ì²˜ë¦¬
            const dish = meal ? meal.DDISH_NM.replace(/<br\s*\/?>/g, '\n').replace(/\([^)]*\)/g, '') : "ê¸‰ì‹ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.";

            // âœ… ì˜¤ëŠ˜ ìš”ì¼ì¸ì§€ í™•ì¸í•˜ì—¬ í´ë˜ìŠ¤ ì¶”ê°€
            const isToday = todayData && todayData.MLSV_YMD === day.key;
            const frontClass = isToday ? 'flip-front today' : 'flip-front';

            const flipCard = document.createElement("div");
            flipCard.className = "flip-card";
            flipCard.innerHTML = `
                <div class="flip-inner">
                <div class="${frontClass}">${day.label}</div>
                <div class="flip-back">${dish}</div>
                </div>
            `;
            // ì¹´ë“œ í´ë¦­ ì‹œ ë’¤ì§‘ëŠ” ê¸°ëŠ¥
            flipCard.addEventListener("click", () => {
                flipCard.classList.toggle("flipped");
            });
            weekContainer.appendChild(flipCard);
        });
      })
      .catch(err => {
        console.error("ê¸‰ì‹ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", err);
        document.getElementById("today-meal").innerText = "ê¸‰ì‹ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
        document.getElementById("today-nutrition").innerText = "";
        document.getElementById("today-date").innerText = "";
      });
  </script>
</body>

</html>
